"use strict";var pu;!function(n){function l(e,t,i){if(e.addEventListener)e.addEventListener(t,i);else{var n=e;n.attachEvent?n.attachEvent("on"+t,i):n[t]=i}}function o(t,i){var e;return(e="object"==typeof t?Object.keys(t).filter(function(e){return"length"!==e}).map(function(e){return t[e]}):t).forEach(function(e){e.uploadStatus=i||e.uploadStatus,e.responseCode=e.responseCode||0,e.responseText=e.responseText||"",e.progress=e.progress||0,e.sentBytes=e.sentBytes||0,e.cancel=e.cancel||function(){}}),e}function a(e,t,i){return void 0===i&&(i=!1),e?i?function(){t(),e()}:function(){e(),t()}:t}function s(e,t){var i=Object(e);for(var n in t)!Object.prototype.hasOwnProperty.call(t,n)||void 0!==i[n]&&null!==i[n]||(i[n]=t[n]);return i}function r(e,t){return new h(e,t)}function c(e){return"function"==typeof e?e():e}function i(){var i=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"===e?t:3&t|8).toString(16)})}function u(e,t,i){if(e.removeEventListener)e.removeEventListener(t,i);else{var n=e;n.detachEvent?n.detachEvent("on"+t,i):n[t]=null}}n.addEventHandler=l,n.isFileApi=!(!window.File||!window.FormData),n.castFiles=o,n.decorateSimpleFunction=a,n.getUploadCore=r,n.getUploader=function(e,t){return new d(e,t)},n.getValueOrResult=c,n.newGuid=i,n.removeEventHandler=u;var p=function(){function e(e,t,i){if(this.targetElement=e,this.options=s(t,this.defaultOptions()),this.uploader=i,this.uploadCore=r(this.options,this.uploader.queue.callbacks),!n.isFileApi)throw"Only browsers with FileAPI supported.";this.setupFileApiElements()}return e.prototype.start=function(e,t){void 0===e&&(e=!1),this.options.manualStart&&(t||this.fileList)&&(this.putFilesToQueue(t),e&&this.clear(t))},e.prototype.clear=function(e){if(this.fileList&&void 0!==e){for(var t=[],i=0;i<this.fileList.length;++i){for(var n=!1,o=0;o<e.length&&!(n=this.fileList[i]===e[o]);++o);n||t.push(this.fileList[i])}this.fileList=t}else this.fileList=null},e.prototype.destroy=function(){this.unregisterOnClick&&this.unregisterOnClick(),this.unregisterOnDrop&&this.unregisterOnDrop(),this.unregisterOnChange&&this.unregisterOnChange(),this.unregisterOnDragOver&&this.unregisterOnDragOver(),this.unregisterOnDragLeave&&this.unregisterOnDragLeave(),this.unregisterOnDragOverGlobal&&this.unregisterOnDragOverGlobal(),this.unregisterOnDragLeaveGlobal&&this.unregisterOnDragLeaveGlobal(),this._fileInput&&document.body.removeChild(this._fileInput)},Object.defineProperty(e.prototype,"fileInput",{get:function(){return this._fileInput},enumerable:!0,configurable:!0}),e.prototype.defaultOptions=function(){return{localizer:{fileSizeInvalid:function(e){return"The selected file exceeds the allowed size of "+e+" or its size is 0 MB. Please choose another file."},fileTypeInvalid:function(e){return"File format is not allowed. Only "+(e||"")+" files are allowed."},invalidResponseFromServer:function(){return"Invalid response from server"}},maxFileSize:1024,allowDragDrop:!0,clickable:!0,accept:"*.*",validateExtension:!1,multiple:!0,allowEmptyFile:!1}},e.prototype.selectFiles=function(e){var t=this;if(this.fileList=o(e),this.options.onFileSelected&&this.fileList.forEach(function(e){t.options.onFileSelected&&t.options.onFileSelected(e)}),this.options.onFilesSelected){var i=[];this.fileList.forEach(function(e){i.push(e)}),this.options.onFilesSelected(i)}this.options.manualStart||this.putFilesToQueue()},e.prototype.putFilesToQueue=function(e){var t=this;(e=e||(this.fileList?this.fileList:void 0))&&(e.forEach(function(e){e.guid=i(),delete e.uploadStatus,e.url=t.uploadCore.getUrl(e),e.onError=t.options.onFileError||function(){},e.onCancel=t.options.onFileCanceled||function(){},t.validateFile(e)?e.start=function(){t.uploadCore.upload([e]),t.options.onFileAdded&&t.options.onFileAdded(e),e.start=function(){}}:e.onError(e)}),this.uploader.queue.addFiles(e))},e.prototype.validateFile=function(e){return this.isFileSizeValid(e)?!this.isFileTypeInvalid(e)||(e.uploadStatus=f.failed,e.responseText=this.options.localizer.fileTypeInvalid(this.options.accept),!1):(e.uploadStatus=f.failed,e.responseText=this.options.localizer.fileSizeInvalid(this.options.maxFileSize),!1)},e.prototype.setupFileApiElements=function(){var t=this;this._fileInput=document.createElement("input"),this._fileInput.setAttribute("type","file"),this._fileInput.setAttribute("accept",this.options.accept?this.options.accept:""),this._fileInput.style.display="none";l(this._fileInput,"change",function(e){return t.onChange(e)}),this.unregisterOnChange=function(){t._fileInput&&u(t._fileInput,"change",onchange)},this.options.multiple&&this._fileInput.setAttribute("multiple",""),this.registerEvents(),document.body.appendChild(this._fileInput)},e.prototype.registerEvents=function(){var t=this,e=function(){return t.onClick()};l(this.targetElement,"click",e),this.unregisterOnClick=function(){return u(t.targetElement,"click",e)};var i=function(e){return t.onDrag(e)};l(this.targetElement,"dragover",i),this.unregisterOnDragOver=function(){return u(t.targetElement,"dragover",i)};var n=function(){return t.onDragLeave()};l(this.targetElement,"dragleave",n),this.unregisterOnDragOver=function(){return u(t.targetElement,"dragleave",n)};var o=function(){return t.onDragGlobal()};l(document.body,"dragover",o),this.unregisterOnDragOverGlobal=function(){return u(document.body,"dragover",o)};var a=function(){return t.onDragLeaveGlobal()};l(document.body,"dragleave",a),this.unregisterOnDragOverGlobal=function(){return u(document.body,"dragleave",a)};var s=function(e){return t.onDrop(e)};l(this.targetElement,"drop",s),this.unregisterOnDrop=function(){return u(t.targetElement,"drop",s)}},e.prototype.onChange=function(e){this.selectFiles(e.target.files)},e.prototype.onDrag=function(e){if(c(this.options.allowDragDrop)){this.addDragOverStyle(this.options.dragOverStyle);var t=void 0;if(e.dataTransfer){try{t=e.dataTransfer.effectAllowed}catch(e){}e.dataTransfer.dropEffect="move"===t||"linkMove"===t?"move":"copy"}this.stopEventPropagation(e)}},e.prototype.onDragLeave=function(){c(this.options.allowDragDrop)&&this.removeDragOverStyle(this.options.dragOverStyle)},e.prototype.onDragGlobal=function(){c(this.options.allowDragDrop)&&this.addDragOverStyle(this.options.dragOverGlobalStyle)},e.prototype.onDragLeaveGlobal=function(){c(this.options.allowDragDrop)&&this.removeDragOverStyle(this.options.dragOverGlobalStyle)},e.prototype.removeDragOverStyle=function(e){e&&this.targetElement.classList.remove(e)},e.prototype.addDragOverStyle=function(e){e&&this.targetElement.classList.add(e)},e.prototype.onDrop=function(e){if(c(this.options.allowDragDrop)&&(this.stopEventPropagation(e),e.dataTransfer)){this.removeDragOverStyle(this.options.dragOverStyle);var t=e.dataTransfer.files;if(t.length){this.options.multiple||(t=[t[0]]);var i=e.dataTransfer.items;if(i&&i.length&&null!==i[0].webkitGetAsEntry)if(this.options.multiple)this.addFilesFromItems(i);else{var n=[i[0]];this.addFilesFromItems(n)}else this.handleFiles(t)}}},e.prototype.isIeVersion=function(e){return RegExp("msie"+(isNaN(e)?"":"\\s"+e.toString()),"i").test(navigator.userAgent)},e.prototype.onClick=function(){var e=this;c(this.options.clickable)&&this._fileInput&&(this._fileInput.value="",this.isIeVersion(10)?setTimeout(function(){e._fileInput&&e._fileInput.click()},200):this._fileInput.click())},e.prototype.addFilesFromItems=function(e){for(var t,i=0;i<e.length;i++){var n=e[i];n.webkitGetAsEntry&&(t=n.webkitGetAsEntry())?t.isFile?this.selectFiles([n.getAsFile()]):t.isDirectory&&this.processDirectory(t,t.name):n.getAsFile&&(n.kind&&"file"!==n.kind||this.selectFiles([n.getAsFile()]))}},e.prototype.processDirectory=function(e,n){var t=e.createReader(),o=this;t.readEntries(function(e){for(var t=0;t<e.length;t++){var i=e[t];i.isFile?i.file(function(e){"."!==e.name.substring(0,1)&&(e.fullPath=n+"/"+e.name,o.selectFiles([e]))}):i.isDirectory&&o.processDirectory(i,n+"/"+i.name)}},function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0})},e.prototype.handleFiles=function(e){for(var t=0;t<e.length;t++)this.selectFiles([e[t]])},e.prototype.isFileSizeValid=function(e){var t=1024*this.options.maxFileSize*1024;return!(e.size>t||!this.options.allowEmptyFile&&0===e.size)},e.prototype.isFileTypeInvalid=function(e){if(e.name&&this.options.accept&&("*"!==this.options.accept.trim()||"*.*"!==this.options.accept.trim())&&this.options.validateExtension&&-1===this.options.accept.indexOf("/")){var t=this.options.accept.split(","),i=e.name.substring(e.name.lastIndexOf("."),e.name.length);if(-1===i.indexOf("."))return!0;for(var n=!0,o=0;o<t.length;o++)t[o].toUpperCase().trim()===i.toUpperCase()&&(n=!1);return n}return!1},e.prototype.stopEventPropagation=function(e){e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},e}();n.UploadArea=p;var h=function(){function e(e,t){void 0===t&&(t={}),this.callbacks=t,this.options=s(e,this.getDefaultOptions()),this.setFullCallbacks(t)}return e.prototype.upload=function(e){var t=this;n.isFileApi&&o(e,f.uploading).forEach(function(e){return t.processFile(e)})},e.prototype.getUrl=function(e){return"function"==typeof this.options.url?this.options.url(e):this.options.url},e.prototype.processFile=function(e){var t=this.createRequest(e);this.setCallbacks(t,e),this.send(t,e)},e.prototype.createRequest=function(e){var t=new XMLHttpRequest,i=e.url||this.getUrl(e);return t.open(this.options.method,i,!0),t.withCredentials=!!this.options.withCredentials,this.setHeaders(t),t},e.prototype.setHeaders=function(i){var n=this;this.options.headers&&(this.options.headers.Accept||i.setRequestHeader("Accept","application/json"),this.options.headers["Cache-Control"]||i.setRequestHeader("Cache-Control","no-cache"),this.options.headers["X-Requested-With"]||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(this.options.headers).forEach(function(e){if(n.options.headers){var t=n.options.headers[e];null!=t&&i.setRequestHeader(e,(t||"").toString())}}))},e.prototype.setCallbacks=function(e,t){var i=this;t.cancel=a(t.cancel,function(){e.abort(),t.uploadStatus=f.canceled,t.onCancel&&t.onCancel(t),i.callbacks.onCancelledCallback&&i.callbacks.onCancelledCallback(t),i.callbacks.onFileStateChangedCallback&&i.callbacks.onFileStateChangedCallback(t),i.callbacks.onFinishedCallback&&i.callbacks.onFinishedCallback(t)},!0),e.onload=function(){return i.onload(t,e)},e.onerror=function(){return i.handleError(t,e)},e.upload.onprogress=function(e){return i.updateProgress(t,e)}},e.prototype.send=function(e,t){var i=this.createFormData(t);this.callbacks.onUploadStartedCallback&&this.callbacks.onUploadStartedCallback(t),this.callbacks.onFileStateChangedCallback&&this.callbacks.onFileStateChangedCallback(t),e.send(i)},e.prototype.createFormData=function(e){var i=this,n=new FormData;return this.options.params&&Object.keys(this.options.params).forEach(function(e){if(i.options.params){var t=i.options.params[e];null!=t&&n.append(e,i.castParamType(t))}}),n.append("file",e,e.name),n},e.prototype.castParamType=function(e){return this.isBoolean(e)||this.isNumber(e)?e.toString():e},e.prototype.isNumber=function(e){return"number"==typeof e},e.prototype.isBoolean=function(e){return"number"==typeof e},e.prototype.handleError=function(e,t){e.uploadStatus=f.failed,this.setResponse(e,t),e.onError&&e.onError(e),this.callbacks.onErrorCallback&&this.callbacks.onErrorCallback(e),this.callbacks.onFileStateChangedCallback&&this.callbacks.onFileStateChangedCallback(e),this.callbacks.onFinishedCallback&&this.callbacks.onFinishedCallback(e)},e.prototype.updateProgress=function(e,t){t?t.lengthComputable?(e.progress=Math.round(t.loaded/t.total*100),e.sentBytes=t.loaded):(e.progress=0,e.sentBytes=0):(e.progress=100,e.sentBytes=e.size),this.callbacks.onProgressCallback&&this.callbacks.onProgressCallback(e)},e.prototype.onload=function(e,t){4===t.readyState&&(100!==e.progress&&this.updateProgress(e),200===t.status?this.finished(e,t):this.handleError(e,t))},e.prototype.finished=function(e,t){e.uploadStatus=f.uploaded,this.setResponse(e,t),this.callbacks.onUploadedCallback&&this.callbacks.onUploadedCallback(e),this.callbacks.onFileStateChangedCallback&&this.callbacks.onFileStateChangedCallback(e),this.callbacks.onFinishedCallback&&this.callbacks.onFinishedCallback(e)},e.prototype.setResponse=function(e,t){e.responseCode=t.status,e.responseText=t.responseText||t.statusText||(t.status?t.status.toString():this.options.localizer.invalidResponseFromServer())},e.prototype.getDefaultOptions=function(){return{headers:{},params:{},withCredentials:!1,localizer:{fileSizeInvalid:function(e){return"The selected file exceeds the allowed size of "+e+" or its size is 0 MB. Please choose another file."},fileTypeInvalid:function(e){return"File format is not allowed. Only "+(e||"")+" files are allowed."},invalidResponseFromServer:function(){return"Invalid response from server"}}}},e.prototype.setFullCallbacks=function(e){this.callbacks.onProgressCallback=e.onProgressCallback||function(){},this.callbacks.onCancelledCallback=e.onCancelledCallback||function(){},this.callbacks.onFinishedCallback=e.onFinishedCallback||function(){},this.callbacks.onUploadedCallback=e.onUploadedCallback||function(){},this.callbacks.onErrorCallback=e.onErrorCallback||function(){},this.callbacks.onUploadStartedCallback=e.onUploadStartedCallback||function(){},this.callbacks.onFileStateChangedCallback=e.onFileStateChangedCallback||function(){}},e}();n.UploadCore=h;var d=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.options=e,this.uploadAreas=[],this.queue=new g(e,t)}return e.prototype.registerArea=function(e,t){var i=new p(e,t,this);return this.uploadAreas.push(i),i},e.prototype.unregisterArea=function(e){var t=this.uploadAreas.indexOf(e);0<=t&&(this.uploadAreas[t].destroy(),this.uploadAreas.splice(t,1))},Object.defineProperty(e.prototype,"firstUploadArea",{get:function(){return this.uploadAreas[0]},enumerable:!0,configurable:!0}),e}();n.Uploader=d;var f,e,g=function(){function e(e,t){this.offset={fileCount:0,running:!1},this.queuedFiles=[],this.options=e,this.callbacks=t,this.setFullOptions(),this.setFullCallbacks()}return e.prototype.addFiles=function(e){var i=this;e.forEach(function(t){i.queuedFiles.some(function(e){return e===t||!!e.guid&&e.guid===t.guid})||(i.queuedFiles.push(t),t.remove=a(t.remove,function(){i.removeFile(t)})),i.callbacks.onFileAddedCallback&&i.callbacks.onFileAddedCallback(t),t.uploadStatus===f.failed?i.callbacks.onErrorCallback&&i.callbacks.onErrorCallback(t):t.uploadStatus=f.queued}),this.filesChanged()},e.prototype.removeFile=function(e,t){void 0===t&&(t=!1);var i=this.queuedFiles.indexOf(e);i<0||(this.deactivateFile(e),this.queuedFiles.splice(i,1),this.callbacks.onFileRemovedCallback&&this.callbacks.onFileRemovedCallback(e),t||this.filesChanged())},e.prototype.clearFiles=function(t,e){var i=this;void 0===t&&(t=[]),void 0===e&&(e=!1),e||(t=t.concat([f.queued,f.uploading])),this.queuedFiles.filter(function(e){return t.indexOf(e.uploadStatus)<0}).forEach(function(e){return i.removeFile(e,!0)}),this.callbacks.onQueueChangedCallback&&this.callbacks.onQueueChangedCallback(this.queuedFiles)},e.prototype.filesChanged=function(){this.options.autoRemove&&this.removeFinishedFiles(),this.options.autoStart&&this.startWaitingFiles(),this.callbacks.onQueueChangedCallback&&this.callbacks.onQueueChangedCallback(this.queuedFiles),this.checkAllFinished()},e.prototype.checkAllFinished=function(){0===this.queuedFiles.filter(function(e){return 0<=[f.queued,f.uploading].indexOf(e.uploadStatus)}).length&&this.callbacks.onAllFinishedCallback&&this.callbacks.onAllFinishedCallback()},e.prototype.setFullOptions=function(){this.options.maxParallelUploads=this.options.maxParallelUploads||0,this.options.parallelBatchOffset=this.options.parallelBatchOffset||0,this.options.autoStart=n.isFileApi&&(this.options.autoStart||!1),this.options.autoRemove=this.options.autoRemove||!1},e.prototype.setFullCallbacks=function(){var e=this;this.callbacks.onFileAddedCallback=this.callbacks.onFileAddedCallback||function(){},this.callbacks.onFileRemovedCallback=this.callbacks.onFileRemovedCallback||function(){},this.callbacks.onAllFinishedCallback=this.callbacks.onAllFinishedCallback||function(){},this.callbacks.onQueueChangedCallback=this.callbacks.onQueueChangedCallback||function(){},this.callbacks.onFileStateChangedCallback=function(){return e.filesChanged()}},e.prototype.startWaitingFiles=function(){this.getWaitingFiles().forEach(function(e){return e.start()})},e.prototype.removeFinishedFiles=function(){var t=this;this.queuedFiles.filter(function(e){return 0<=[f.uploaded,f.canceled].indexOf(e.uploadStatus)}).forEach(function(e){return t.removeFile(e,!0)})},e.prototype.deactivateFile=function(e){e.uploadStatus===f.uploading&&e.cancel(),e.uploadStatus=f.removed,e.cancel=function(){},e.remove=function(){},e.start=function(){}},e.prototype.getWaitingFiles=function(){if(!this.options.autoStart)return[];var e=this.queuedFiles.filter(function(e){return e.uploadStatus===f.queued});if(this.options.maxParallelUploads){var t=this.queuedFiles.filter(function(e){return e.uploadStatus===f.uploading}).length,i=Math.min(e.length,this.options.maxParallelUploads-t);if(i<=0)return[];this.options.parallelBatchOffset&&(this.offset.running||this.startOffset(),i=Math.min(this.offset.fileCount+i,this.options.maxParallelUploads)-this.offset.fileCount,this.offset.fileCount+=i),e=e.slice(0,i)}return e},e.prototype.startOffset=function(){var e=this;this.offset.fileCount=0,this.offset.running=!0,setTimeout(function(){e.offset.fileCount=0,e.offset.running=!1,e.filesChanged()},this.options.parallelBatchOffset)},e}();n.UploadQueue=g,(e=f=n.UploadStatus||(n.UploadStatus={}))[e.queued=0]="queued",e[e.uploading=1]="uploading",e[e.uploaded=2]="uploaded",e[e.failed=3]="failed",e[e.canceled=4]="canceled",e[e.removed=5]="removed"}(pu||(pu={}));